import{a as ot}from"./chunk-ERC2T7MB.js";import{a as $,b as G,c as K,d as Q,e as X,f as Y,g as tt}from"./chunk-DTPQ4QLT.js";import{A as u,B as p,D as r,E as n,F as h,G as I,H as l,I as f,J as y,N as s,O as g,P as T,Q as A,R as L,S as R,a as k,b as F,e as O,ea as W,fa as w,h as V,ha as H,i as S,ia as q,ja as z,k as B,l as _,la as J,m as C,oa as U,p as P,q as b,qa as Z,u as x,ua as j,v as c,va as et,w as d}from"./chunk-76W25EPH.js";var v=class o{constructor(e){this.http=e}API="https://backend-produto.onrender.com/produtos";listar(e="",t="nome",i="asc"){let a=new q().set("orderBy",t).set("orderDir",i);return e&&(a=a.set("search",e)),this.http.get(this.API,{params:a}).pipe(O(m=>m.data))}buscarPorId(e){return this.http.get(`${this.API}/${e}`).pipe(O(t=>t.data))}static \u0275fac=function(t){return new(t||o)(B(z))};static \u0275prov=V({token:o,factory:o.\u0275fac,providedIn:"root"})};function ct(o,e){o&1&&(r(0,"div",16),s(1," Nenhum produto encontrado. "),n())}function mt(o,e){if(o&1){let t=I();r(0,"div",17)(1,"div",18),h(2,"img",19),r(3,"div",20)(4,"h5",21),s(5),n(),r(6,"p",22),s(7),n(),r(8,"button",23),l("click",function(){let a=P(t).$implicit,m=f();return b(m.verDetalhes(a.id))}),s(9," Detalhes "),n()()()()}if(o&2){let t=e.$implicit;c(2),y("alt",t.nome),p("src",t.imagem,x),c(3),g(t.nome),c(2),T("R$ ",t.preco,"")}}var N=class o{constructor(e,t){this.produtoService=e;this.router=t}produtos=[];searchTerm="";ordenacaoSelecionada="nome-asc";searchTimeout;ngOnInit(){this.buscar()}onSearch(){clearTimeout(this.searchTimeout),(this.searchTerm.length>=3||this.searchTerm.length===0)&&(this.searchTimeout=setTimeout(()=>{let[e,t]=this.ordenacaoSelecionada?this.ordenacaoSelecionada.split("-"):["nome","asc"];this.buscar(this.searchTerm,e,t)},300))}limparBusca(){this.searchTerm="",this.ordenacaoSelecionada="nome-asc",this.buscar()}buscar(e="",t="nome",i="asc"){this.produtoService.listar(e,t,i).subscribe({next:a=>this.produtos=a,error:()=>this.produtos=[]})}verDetalhes(e){this.router.navigate(["/produtos",e])}static \u0275fac=function(t){return new(t||o)(d(v),d(Z))};static \u0275cmp=_({type:o,selectors:[["app-produto-list"]],decls:22,vars:4,consts:[[1,"container","mt-4"],[1,"row","mb-3"],[1,"col-md-5"],["type","text","placeholder","Buscar produto...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"col-md-4"],[1,"form-select",3,"ngModelChange","change","ngModel"],["value",""],["value","nome-asc"],["value","nome-desc"],["value","preco-asc"],["value","preco-desc"],[1,"col-md-3"],[1,"btn","btn-secondary","w-100",3,"click"],["class","alert alert-warning text-center",4,"ngIf"],[1,"row"],["class","col-6 col-md-4 col-lg-3 col-xl-2 mb-4",4,"ngFor","ngForOf"],[1,"alert","alert-warning","text-center"],[1,"col-6","col-md-4","col-lg-3","col-xl-2","mb-4"],[1,"card","h-100"],[1,"card-img-top","img-fluid",3,"src","alt"],[1,"card-body","d-flex","flex-column"],[1,"card-title"],[1,"card-text","fw-bold"],[1,"btn","btn-primary","mt-auto",3,"click"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"input",3),R("ngModelChange",function(m){return L(i.searchTerm,m)||(i.searchTerm=m),m}),l("input",function(){return i.onSearch()}),n()(),r(4,"div",4)(5,"select",5),R("ngModelChange",function(m){return L(i.ordenacaoSelecionada,m)||(i.ordenacaoSelecionada=m),m}),l("change",function(){return i.onSearch()}),r(6,"option",6),s(7,"Ordenar por..."),n(),r(8,"option",7),s(9,"Nome (A-Z)"),n(),r(10,"option",8),s(11,"Nome (Z-A)"),n(),r(12,"option",9),s(13,"Pre\xE7o (menor primeiro)"),n(),r(14,"option",10),s(15,"Pre\xE7o (maior primeiro)"),n()()(),r(16,"div",11)(17,"button",12),l("click",function(){return i.limparBusca()}),s(18,"Limpar"),n()()(),u(19,ct,2,0,"div",13),r(20,"div",14),u(21,mt,10,4,"div",15),n()()),t&2&&(c(3),A("ngModel",i.searchTerm),c(2),A("ngModel",i.ordenacaoSelecionada),c(14),p("ngIf",i.produtos.length===0),c(2),p("ngForOf",i.produtos))},dependencies:[W,w,X,Y,$,Q,G,K]})};function dt(o,e){if(o&1&&h(0,"img",11),o&2){let t=f(2);y("alt",t.produto.nome),p("src",t.produto.imagem,x)}}function pt(o,e){if(o&1){let t=I();r(0,"div",1)(1,"div",2)(2,"div",3),u(3,dt,1,2,"img",4),n(),r(4,"div",5)(5,"h2",6),s(6),n(),r(7,"p",7),s(8),n(),r(9,"h4",8),s(10),n(),r(11,"button",9),l("click",function(){P(t);let a=f();return b(a.adicionarAoCarrinho())}),h(12,"i",10),s(13," Adicionar ao Carrinho "),n()()()()}if(o&2){let t=f();c(3),p("ngIf",t.produto.imagem),c(3),g(t.produto.nome),c(2),g(t.produto.descricao),c(2),T("R$ ",t.produto.preco,"")}}var D=class o{constructor(e,t,i,a){this.route=e;this.produtoService=t;this.carrinhoService=i;this.toast=a}produto;ngOnInit(){let e=Number(this.route.snapshot.paramMap.get("id"));this.produtoService.buscarPorId(e).subscribe(t=>{this.produto=t})}adicionarAoCarrinho(){let e=F(k({},this.produto),{quantidadeNoCarrinho:1}),t=JSON.parse(localStorage.getItem("carrinho")||"[]"),i=t.find(a=>a.id===e.id);i?i.quantidadeNoCarrinho++:t.push(e),localStorage.setItem("carrinho",JSON.stringify(t)),this.carrinhoService.adicionar(this.produto),this.toast.show("Produto adicionado ao carrinho!","success")}static \u0275fac=function(t){return new(t||o)(d(U),d(v),d(et),d(ot))};static \u0275cmp=_({type:o,selectors:[["app-produto-detail"]],decls:1,vars:1,consts:[["class","container py-5",4,"ngIf"],[1,"container","py-5"],[1,"row"],[1,"col-md-5"],["class","img-fluid rounded shadow-sm",3,"src","alt",4,"ngIf"],[1,"col-md-7","d-flex","flex-column"],[1,"mb-3"],[1,"text-muted"],[1,"text-primary","fw-bold","mb-4"],[1,"btn","btn-success","btn-lg","mt-auto","align-self-start",3,"click"],[1,"bi","bi-cart-plus","me-2"],[1,"img-fluid","rounded","shadow-sm",3,"src","alt"]],template:function(t,i){t&1&&u(0,pt,14,4,"div",0),t&2&&p("ngIf",i.produto)},dependencies:[w]})};var lt=[{path:"",component:N},{path:":id",component:D}],E=class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=C({type:o});static \u0275inj=S({imports:[j.forChild(lt),j]})};var rt=class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=C({type:o});static \u0275inj=S({imports:[H,tt,J,E]})};export{rt as ProdutosModule};
